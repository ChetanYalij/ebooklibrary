<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css" rel="stylesheet"/>
</head>

<body class="bg-base-100 min-h-screen">

<!-- ================= NAVBAR ================= -->
<div class="navbar bg-base-200 shadow">
  <div class="flex-1">
    <a href="/" class="btn btn-ghost text-xl font-bold">
      üìö E-Library Admin
    </a>
  </div>

  <div class="flex-none gap-2">
    <a href="{{ url_for('upload') }}" class="btn btn-sm btn-primary">
      ‚ûï Upload Book
    </a>
    <a href="{{ url_for('logout') }}" class="btn btn-sm btn-outline btn-error">
      Logout
    </a>
    <span class="badge badge-primary">ADMIN</span>
  </div>
</div>

<div class="container mx-auto px-6 py-8">

  <!-- ================= STATS ================= -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
    <div class="stat bg-base-200 rounded-xl shadow">
      <div class="stat-title">Total Books</div>
      <div class="stat-value text-primary">{{ total_books }}</div>
    </div>

    <div class="stat bg-base-200 rounded-xl shadow">
      <div class="stat-title">Total Authors</div>
      <div class="stat-value text-secondary">{{ total_authors }}</div>
    </div>

    <div class="stat bg-base-200 rounded-xl shadow">
      <div class="stat-title">Categories</div>
      <div class="stat-value text-accent">{{ category_stats|length }}</div>
    </div>
  </div>

  <!-- ================= CATEGORY STATS ================= -->
  <div class="card bg-base-200 shadow mb-10">
    <div class="card-body">
      <h2 class="card-title">üìÇ Category Distribution</h2>

      {% if category_stats %}
        <ul class="mt-4 space-y-2">
          {% for cat, count in category_stats %}
          <li class="flex justify-between border-b pb-1">
            <span>{{ cat }}</span>
            <span class="badge badge-outline">{{ count }}</span>
          </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="text-sm opacity-60 mt-3">No categories found</p>
      {% endif %}
    </div>
  </div>

  <!-- ================= RECENT BOOKS + ACTIONS ================= -->
  <div class="card bg-base-200 shadow">
    <div class="card-body">
      <h2 class="card-title">üÜï Recently Added Books</h2>

      <ul class="mt-4 space-y-4">
        {% for book in recent_books %}
        <li class="border-b pb-3">
          <div class="flex justify-between items-start">
            <div>
              <strong class="text-lg">{{ book.title }}</strong>
              <div class="text-xs opacity-70">by {{ book.author }}</div>
            </div>

            <!-- ACTION BUTTONS -->
            <div class="flex gap-2">
              <a href="{{ url_for('edit_book', book_id=book.id) }}"
                 class="btn btn-xs btn-outline">
                ‚úèÔ∏è Edit
              </a>

              <form method="POST"
                    action="{{ url_for('delete_book', book_id=book.id) }}"
                    onsubmit="return confirm('Are you sure you want to delete this book?');">
                <button type="submit" class="btn btn-xs btn-error">
                  üóë Delete
                </button>
              </form>
            </div>
          </div>
        </li>
        {% else %}
        <li class="text-sm opacity-60">No books found</li>
        {% endfor %}
      </ul>

    </div>
  </div>

</div>

</body>
</html>
